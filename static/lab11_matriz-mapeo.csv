#,Vulnerabilidad,Archivo,Líneas,Severidad,OWASP Top 10,CWE,Control ISO 27002,Descripción Control,¿Cómo se violó?,Impacto Potencial,Remediación,Esfuerzo (hrs)
1,SQL Injection,ProductController.cs,23-27,CRÍTICA,A03:2021 - Injection,CWE-89,8.28 - Secure coding,Las aplicaciones deben desarrollarse siguiendo principios de codificación segura,No se usaron prepared statements ni validación de input,Acceso no autorizado a BD completa / Robo de datos / Modificación de datos / Eliminación de datos,Usar consultas parametrizadas (prepared statements) o Entity Framework LINQ,2
2,Credenciales Hardcodeadas,appsettings.json,8-10,CRÍTICA,A05:2021 - Security Misconfiguration,CWE-798,8.24 - Use of cryptography,Se debe proteger información sensible mediante criptografía,Contraseña de BD en texto plano en archivo de configuración,Acceso completo a base de datos si el repositorio es comprometido,Migrar a Azure Key Vault o User Secrets para desarrollo,4
3,IDOR (Broken Access Control),OrderController.cs,15-38,ALTA,A01:2021 - Broken Access Control,CWE-639,5.15 - Access control / 8.3 - Information access restriction,El acceso a información debe estar restringido según políticas de control de acceso,No se valida que el usuario autenticado sea dueño del recurso,Usuario puede ver/modificar órdenes de otros usuarios / Violación de privacidad,Validar ownership: if (order.UserId != currentUserId && !isAdmin) return Forbid(),3
4,Verbose Error Messages,UserController.cs,30-56,ALTA,A05:2021 - Security Misconfiguration,CWE-209,8.28 - Secure coding,El manejo de errores debe ser seguro y no revelar información sensible,Mensajes de error diferentes revelan si usuario existe / Stack trace expuesto,Enumeración de usuarios válidos / Información sobre estructura interna de la app,Implementar middleware global de error handling con mensajes genéricos,2
4b,Contraseña en Texto Plano,UserController.cs / User.cs,14-16 (User.cs),CRÍTICA,A02:2021 - Cryptographic Failures,CWE-256,8.24 - Use of cryptography,Se debe usar criptografía para proteger datos sensibles,Contraseñas almacenadas sin hash,Compromiso total de cuentas si la BD es accedida,Usar bcrypt o Argon2 para hash de contraseñas,3
5,Missing Input Validation,ProductController.cs,35-72,MEDIA,A03:2021 - Injection,CWE-20,8.28 - Secure coding,Todo input debe ser validado,No se valida precio positivo / longitud de strings / caracteres especiales,XSS potencial / Datos inconsistentes en BD / Posible DoS por strings muy largos,Implementar FluentValidation o Data Annotations,4
6,Sensitive Data in Logs,UserController.cs,58-62,MEDIA,A09:2021 - Security Logging Failures,CWE-532,8.16 - Monitoring activities / 8.19 - Security of information in use,Los logs deben proteger información sensible,Contraseñas y emails registrados en logs de texto plano,Exposición de credenciales si logs son comprometidos / Violación de privacidad,Sanitizar logs: nunca loggear contraseñas; ofuscar datos sensibles,2
7,Missing Security Headers,Program.cs,1-29,BAJA,A05:2021 - Security Misconfiguration,CWE-693,8.28 - Secure coding,Las aplicaciones deben configurarse de manera segura,No se configuran headers de seguridad (X-Frame-Options; CSP; HSTS; etc.),Vulnerable a clickjacking / XSS / Downgrade attacks,Agregar middleware de security headers o usar librería SecurityHeaders,1
